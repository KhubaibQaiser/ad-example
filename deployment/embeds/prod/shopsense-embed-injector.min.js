!function(e){e.ShopsenseEmbeds=e.ShopsenseEmbeds||{},e.ShopsenseEmbeds.EmbedInjector=function(){let e=0;const t=(e,t,n=!1)=>{n&&(e.style.cssText=""),Object.assign(e.style,t)};return{loadAd:async function(n){if(!n.containerId)throw new Error("containerId must be provided.");if(!n.embedId)throw new Error("embedId must be provided.");const o=`https://embeds.prod.shopsense.ai/tastemade/${n.embedId}/ad`,s=`${o}/index.html`,r=`${o}/assets`;try{const c=document.getElementById(n.containerId);if(!c)throw new Error(`Element with id="${n.containerId}" not found.`);t(c,{position:"relative",height:0,overflow:"hidden",opacity:0,transition:"all 0.5s ease"});const d=((e,n)=>{const o=document.createElement("div");return o.id=n,t(o,{zIndex:1}),e.appendChild(o),o})(c,"shopsense-embed-ad"),i=await fetch(s);if(!i.ok)throw new Error("Unable to fetch the ad content.");const a=await i.text(),l=document.createElement("div");l.innerHTML=a;const h=l.querySelectorAll("script"),p=l.querySelectorAll("link"),m=l.querySelectorAll("img"),u=l.querySelectorAll("video");p.forEach((e=>{const t=e.cloneNode(!0),n=t.href.split("/").pop();t.href=`${o}/${n}`,document.head.appendChild(t)})),m.forEach((e=>{const t=e.src.split("/").pop();e.src=`${r}/${t}`})),u.forEach((e=>{const t=(e.getAttribute("data-src")||e.src).split("/").pop(),n=`${r}/${t}`;e.hasAttribute("data-src")?e.setAttribute("data-src",n):e.src=n,e.controls=!1,e.setAttribute("src",n),e.classList.remove("hidden")}));const E=l.getElementsByTagName("main")[0];if(!E)throw new Error("Main content not found in the ad.");E.classList.add("shopsense-ad"),d.innerHTML=E.outerHTML,setTimeout((()=>{t(c,{height:d.clientHeight+"px",opacity:1}),setTimeout((()=>{t(c,{height:"auto"})}),500)}),1e3);let f=[];h.forEach((e=>{e.src&&e.src.includes(".js")&&f.push(e)})),f.forEach((t=>{let n=t.src;n=n.split("/").pop(),n=`${o}/${n}`;const s=document.createElement("script");s.src=n,s.type="text/javascript",s.onload=((t,n=0)=>()=>{if(e++,e===n){console.log("All scripts loaded successfully");const e=new CustomEvent("ShopsenseEmbedInjected",{detail:{container:t}});document.dispatchEvent(e)}})(c,f.length),document.body.appendChild(s)}))}catch(e){}}}}()}(window);