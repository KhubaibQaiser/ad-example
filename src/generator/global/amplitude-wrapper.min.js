window.env = 'ENV_PLACEHOLDER';

window.addEventListener('message', (event) => {
  window.utmParams = event.data || {};

  // Initialize Amplitude with UTM parameters
  window.amplitude.init('AMPLITUDE_API_KEY', {
    autocapture: { elementInteractions: true, attribution: true },
    includeUtm: true,
    includeReferrer: true,
  });

  // Create an Identify object and set UTM parameters
  const identify = new amplitude.Identify();
  for (const [key, value] of Object.entries(utmParams)) {
    if (value) {
      identify.set(key, value);
    }
  }

  // Send the Identify call to set user properties
  window.amplitude.identify(identify);
});

var events = {};
const logEvent = (_n, t = {}) => {
  const n = `Ads - ${_n}`;
  const key = `${n}${JSON.stringify(t)}`;
  if (!events[key]) {
    events[key] = JSON.stringify(t);
    console.log(`Event: ${n}`, t);
    if (window.env === 'production') {
      window.amplitude.logEvent(n, t);
    }
  }
};
window.analytics = { logEvent: logEvent };
