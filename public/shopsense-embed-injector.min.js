!function(e){e.ShopsenseEmbeds=e.ShopsenseEmbeds||{},e.ShopsenseEmbeds.EmbedInjector=function(){const e={Skyscraper:"Skyscraper",Banner:"Banner",Leaderboard:"Leaderboard"},t={Skyscraper:{width:"160px",height:"600px"},Banner:{width:"468px",height:"60px"},Leaderboard:{width:"728px",height:"90px"}};let o=0;const r=(e,t=0)=>()=>{if(o++,console.log("SCRIPT LOADED",{scriptsCount:t,scriptsLoaded:o}),o===t){console.log("All scripts loaded successfully");const t=new CustomEvent("ShopsenseEmbedInjected",{detail:{container:e}});document.dispatchEvent(t)}},s=(e,t)=>{const o=document.createElement("div");o.id="shopsense-embed-loader",o.style.width=e,o.style.height=t,o.style.backgroundColor="rgba(0,0,0,1)",o.style.position="absolute",o.style.left=0,o.style.top=0,o.style.opacity=1,o.style.transition="opacity 0.5s ease",o.style.zIndex=10;return{loaderContainer:o,hideLoader:()=>{o.style.opacity=0,setTimeout((()=>{o.remove()}),500)}}},n=(e,t)=>{const o=document.createElement("div");return o.id="shopsense-embed-ad",o.style.width=e,o.style.height=t,o.style.zIndex=1,o};return{loadAd:async function(o){if(!o.containerId)throw new Error("containerId must be provided.");if(!o.embedId)throw new Error("embedId must be provided.");if(!o.template)throw new Error("template must be provided.");o.variation=o.variation||e.Skyscraper;const a=o.variation&&t[o.variation]||t.Skyscraper,d=a.width||"auto",i=a.height||"auto",c=`https://ad-example.vercel.app/ads/${o.embedId}/${o.template}/ad`,l=`${c}/index.html`,p=`${c}/assets`;try{const e=document.getElementById(o.containerId);if(!e)throw new Error(`Element with id="${o.containerId}" not found.`);e.style.position="relative",e.style.width=d,e.style.height=i,e.style.overflow="hidden";const{loaderContainer:t,hideLoader:a}=s(d,i);e.appendChild(t);const h=n(d,i);e.appendChild(h);const u=await fetch(l);if(!u.ok)throw new Error("Unable to fetch the ad content.");const m=await u.text(),y=document.createElement("div");y.innerHTML=m;const E=y.querySelectorAll("script"),w=y.querySelectorAll("link"),b=y.querySelectorAll("img"),f=y.querySelectorAll("video");console.log("FOUND",{scripts:E,links:w,images:b,videos:f}),w.forEach((e=>{const t=e.cloneNode(!0),o=t.href.split("/").pop();t.href=`${c}/${o}`,document.head.appendChild(t)})),b.forEach((e=>{const t=e.src.split("/").pop();e.src=`${p}/${t}`})),f.forEach((e=>{const t=(e.getAttribute("data-src")||e.src).split("/").pop();e.hasAttribute("data-src")?e.setAttribute("data-src",`${p}/${t}`):e.src=`${p}/${t}`,e.controls=!0}));const g=y.getElementsByTagName("main")[0];if(!g)throw new Error("Main content not found in the ad.");g.classList.add("shopsense-ad"),h.innerHTML=g.outerHTML,setTimeout(a,250);let v=[];E.forEach((e=>{e.src&&e.src.includes(".js")&&v.push(e)})),v.forEach((t=>{let o=t.src;o=o.split("/").pop(),o=`${c}/${o}`;const s=document.createElement("script");s.src=o,s.type="text/javascript",s.onload=r(e,v.length),document.body.appendChild(s)}))}catch(e){console.error("Error loading ad:",e)}},SupportedTemplates:{CuratedProducts:"curated-products-template",Carousel:"carousel-template"},SupportedVariations:e}}()}(window);