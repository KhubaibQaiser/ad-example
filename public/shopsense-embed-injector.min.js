!function(e){e.ShopsenseEmbeds=e.ShopsenseEmbeds||{},e.ShopsenseEmbeds.EmbedInjector=function(){let e=0;const t=(e,t,o=!1)=>{o&&(e.style.cssText=""),Object.assign(e.style,t)};return{loadAd:async function(o){if(!o.containerId)throw new Error("containerId must be provided.");if(!o.embedId)throw new Error("embedId must be provided.");const n=`https://embeds.dev.shopsense.ai/tastemade/${o.embedId}/ad`,s=`${n}/index.html`,r=`${n}/assets`;try{const c=document.getElementById(o.containerId);if(!c)throw new Error(`Element with id="${o.containerId}" not found.`);t(c,{position:"relative",height:0,overflow:"hidden",opacity:0,transition:"all 0.5s ease"});const d=((e,o)=>{const n=document.createElement("div");return n.id=o,t(n,{zIndex:1}),e.appendChild(n),n})(c,"shopsense-embed-ad"),i=await fetch(s);if(!i.ok)throw new Error("Unable to fetch the ad content.");const a=await i.text(),l=document.createElement("div");l.innerHTML=a;const h=l.querySelectorAll("script"),p=l.querySelectorAll("link"),m=l.querySelectorAll("img"),u=l.querySelectorAll("video");p.forEach((e=>{const t=e.cloneNode(!0),o=t.href.split("/").pop();t.href=`${n}/${o}`,document.head.appendChild(t)})),m.forEach((e=>{const t=e.src.split("/").pop();e.src=`${r}/${t}`})),u.forEach((e=>{const t=(e.getAttribute("data-src")||e.src).split("/").pop(),o=`${r}/${t}`;e.hasAttribute("data-src")?e.setAttribute("data-src",o):e.src=o,e.controls=!1,e.setAttribute("src",o),e.classList.remove("hidden")}));const E=l.getElementsByTagName("main")[0];if(!E)throw new Error("Main content not found in the ad.");E.classList.add("shopsense-ad"),d.innerHTML=E.outerHTML,setTimeout((()=>{t(c,{height:d.clientHeight+"px",opacity:1}),setTimeout((()=>{t(c,{height:"auto"})}),500)}),1e3);let f=[];h.forEach((e=>{e.src&&e.src.includes(".js")&&f.push(e)})),f.forEach((t=>{let o=t.src;o=o.split("/").pop(),o=`${n}/${o}`;const s=document.createElement("script");s.src=o,s.type="text/javascript",s.onload=((t,o=0)=>()=>{if(e++,e===o){console.log("All scripts loaded successfully");const e=new CustomEvent("ShopsenseEmbedInjected",{detail:{container:t}});document.dispatchEvent(e)}})(c,f.length),document.body.appendChild(s)}))}catch(e){console.error("Error loading ad:",e)}}}}()}(window);