!function(e){e.ShopsenseEmbeds=e.ShopsenseEmbeds||{},e.ShopsenseEmbeds.EmbedInjector=function(){const e={Skyscraper:"Skyscraper",Banner:"Banner",Leaderboard:"Leaderboard"},t={Skyscraper:{width:"160px",height:"600px"},Banner:{width:"468px",height:"60px"},Leaderboard:{width:"728px",height:"90px"}};let o=0;const r=(e,t,o=!1)=>{o&&(e.style.cssText=""),Object.assign(e.style,t)};return{loadAd:async function(n){if(!n.containerId)throw new Error("containerId must be provided.");if(!n.embedId)throw new Error("embedId must be provided.");if(!n.template)throw new Error("template must be provided.");n.variation=n.variation||e.Skyscraper;const s=n.variation&&t[n.variation]||t.Skyscraper,a=s.width,d=s.height,i=`https://ad-example.vercel.app/ads/${n.embedId}/${n.template}/ad`,c=`${i}/index.html`,l=`${i}/assets`;try{const e=document.getElementById(n.containerId);if(!e)throw new Error(`Element with id="${n.containerId}" not found.`);r(e,{position:"relative",width:a,height:d,overflow:"hidden"});const t=((e,t,o,n)=>{const s=document.createElement("div");return s.id=t,r(s,{width:o,height:n,backgroundColor:"rgba(0,0,0,1)",position:"absolute",left:0,top:0,opacity:1,transition:"opacity 0.5s ease",zIndex:10}),e.appendChild(s),()=>{s.style.opacity=0,setTimeout((()=>{s.remove()}),500)}})(e,"shopsense-embed-loader",a,d),s=((e,t,o,n)=>{const s=document.createElement("div");return s.id=t,r(s,{width:o,height:n,zIndex:1}),e.appendChild(s),s})(e,"shopsense-embed-ad",a,d),p=await fetch(c);if(!p.ok)throw new Error("Unable to fetch the ad content.");const h=await p.text(),m=document.createElement("div");m.innerHTML=h;const u=m.querySelectorAll("script"),b=m.querySelectorAll("link"),w=m.querySelectorAll("img"),E=m.querySelectorAll("video");console.log("FOUND",{scripts:u,links:b,images:w,videos:E}),b.forEach((e=>{const t=e.cloneNode(!0),o=t.href.split("/").pop();t.href=`${i}/${o}`,document.head.appendChild(t)})),w.forEach((e=>{const t=e.src.split("/").pop();e.src=`${l}/${t}`})),E.forEach((e=>{const t=(e.getAttribute("data-src")||e.src).split("/").pop(),o=`${l}/${t}`;e.hasAttribute("data-src")?e.setAttribute("data-src",o):e.src=o,e.controls=!1,e.setAttribute("src",o),e.classList.remove("hidden")}));const f=m.getElementsByTagName("main")[0];if(!f)throw new Error("Main content not found in the ad.");f.classList.add("shopsense-ad"),s.innerHTML=f.outerHTML,setTimeout(t,250);let y=[];u.forEach((e=>{e.src&&e.src.includes(".js")&&y.push(e)})),y.forEach((t=>{let r=t.src;r=r.split("/").pop(),r=`${i}/${r}`;const n=document.createElement("script");n.src=r,n.type="text/javascript",n.onload=((e,t=0)=>()=>{if(o++,o===t){console.log("All scripts loaded successfully");const t=new CustomEvent("ShopsenseEmbedInjected",{detail:{container:e}});document.dispatchEvent(t)}})(e,y.length),document.body.appendChild(n)}))}catch(e){console.error("Error loading ad:",e)}},SupportedTemplates:{CuratedProducts:"curated-products-template",Carousel:"carousel-template"},SupportedVariations:e}}()}(window);