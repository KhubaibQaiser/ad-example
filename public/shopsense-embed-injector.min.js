!function(e){e.ShopsenseEmbeds=e.ShopsenseEmbeds||{},e.ShopsenseEmbeds.EmbedInjector=function(){const e={Skyscraper:"Skyscraper",Banner:"Banner",Leaderboard:"Leaderboard"},t={Skyscraper:{width:"160px",height:"600px"},Banner:{width:"912px",height:"384px"},Leaderboard:{width:"728px",height:"90px"}};let r=0;const o=(e,t,r=!1)=>{r&&(e.style.cssText=""),Object.assign(e.style,t)};return{loadAd:async function(n){if(!n.containerId)throw new Error("containerId must be provided.");if(!n.embedId)throw new Error("embedId must be provided.");if(!n.template)throw new Error("template must be provided.");n.variation=n.variation||e.Skyscraper;const s=n.variation&&t[n.variation]||t.Skyscraper,a=(s.width,s.height,`https://ad-example.vercel.app/ads/${n.embedId}/${n.template}/ad`),c=`${a}/index.html`,d=`${a}/assets`;try{const e=document.getElementById(n.containerId);if(!e)throw new Error(`Element with id="${n.containerId}" not found.`);o(e,{position:"relative",height:0,overflow:"hidden",opacity:0,transition:"all 0.5s ease"});const t=((e,t)=>{const r=document.createElement("div");return r.id=t,o(r,{zIndex:1}),e.appendChild(r),r})(e,"shopsense-embed-ad"),s=await fetch(c);if(!s.ok)throw new Error("Unable to fetch the ad content.");const i=await s.text(),l=document.createElement("div");l.innerHTML=i;const p=l.querySelectorAll("script"),h=l.querySelectorAll("link"),m=l.querySelectorAll("img"),u=l.querySelectorAll("video");console.log("FOUND",{scripts:p,links:h,images:m,videos:u}),h.forEach((e=>{const t=e.cloneNode(!0),r=t.href.split("/").pop();t.href=`${a}/${r}`,document.head.appendChild(t)})),m.forEach((e=>{const t=e.src.split("/").pop();e.src=`${d}/${t}`})),u.forEach((e=>{const t=(e.getAttribute("data-src")||e.src).split("/").pop(),r=`${d}/${t}`;e.hasAttribute("data-src")?e.setAttribute("data-src",r):e.src=r,e.controls=!1,e.setAttribute("src",r),e.classList.remove("hidden")}));const E=l.getElementsByTagName("main")[0];if(!E)throw new Error("Main content not found in the ad.");E.classList.add("shopsense-ad"),t.innerHTML=E.outerHTML,setTimeout((()=>{o(e,{height:t.clientHeight+"px",opacity:1})}),500);let b=[];p.forEach((e=>{e.src&&e.src.includes(".js")&&b.push(e)})),b.forEach((t=>{let o=t.src;o=o.split("/").pop(),o=`${a}/${o}`;const n=document.createElement("script");n.src=o,n.type="text/javascript",n.onload=((e,t=0)=>()=>{if(r++,r===t){console.log("All scripts loaded successfully");const t=new CustomEvent("ShopsenseEmbedInjected",{detail:{container:e}});document.dispatchEvent(t)}})(e,b.length),document.body.appendChild(n)}))}catch(e){console.error("Error loading ad:",e)}},SupportedTemplates:{CuratedProducts:"curated-products-template",Carousel:"carousel-template",Banner:"banner-template"},SupportedVariations:e}}()}(window);